
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Auto Miles Per Gallon Data Experiments &#8212; Detecting Simpson&#39;s Paradox 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Timing Experiment" href="exp_time.html" />
    <link rel="prev" title="What is Simpson’s Paradox?" href="simple_simpsons_paradox_intro.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../FLAIRS31.html">Reproducing the FLAIRS31 paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_simpsons_paradox_intro.html">What is Simpson’s Paradox?</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Auto Miles Per Gallon Data Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="exp_time.html">Timing Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="exp_iris.html">Iris Data Experiments</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="simple_simpsons_paradox_intro.html" title="previous chapter">What is Simpson’s Paradox?</a></li>
      <li>Next: <a href="exp_time.html" title="next chapter">Timing Experiment</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/notebooks/exp_autompg.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Auto-Miles-Per-Gallon-Data-Experiments">
<h1>Auto Miles Per Gallon Data Experiments<a class="headerlink" href="#Auto-Miles-Per-Gallon-Data-Experiments" title="Permalink to this headline">¶</a></h1>
<p>This notebook runs the experiments and generates the figures on the
<a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/auto+mpg">auto mpg data</a>. We
are working with a subset of the data created by:</p>
<ol class="arabic simple">
<li>selecting a subset of columns to suit our problem setting: three
continuous (mpg, acceleration, and horsepower) and three categorical
attributes (cylinders, model year, and origin)</li>
<li>removing incomplete records</li>
</ol>
<p>This notebook generates the results and figures related to the AutoMPG
experiments</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># clean up notebook output by removing warnings about future changes</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="c1"># our code packaged for easy use</span>
<span class="kn">import</span> <span class="nn">detect_simpsons_paradox</span> <span class="k">as</span> <span class="nn">dsp</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># import the prepared copy of the data</span>
<span class="n">auto_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/auto2.csv&#39;</span><span class="p">)</span>
<span class="n">auto_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>horsepower</th>
      <th>acceleration</th>
      <th>model year</th>
      <th>origin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>130.0</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>165.0</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>150.0</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>150.0</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>140.0</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>From examining the above, we know that the integer columns are the
group-by variables and the float type variables are the continuous
attributes. The detector function will automatically</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groupbyAttrs</span> <span class="o">=</span> <span class="n">auto_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span>
<span class="n">groupbyAttrs_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">groupbyAttrs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">groupbyAttrs_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;cylinders&#39;, &#39;model year&#39;, &#39;origin&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">continuousAttrs</span> <span class="o">=</span> <span class="n">auto_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span>
<span class="n">continuousAttrs_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">continuousAttrs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">continuousAttrs_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;mpg&#39;, &#39;horsepower&#39;, &#39;acceleration&#39;]
</pre></div></div>
</div>
<div class="section" id="Results">
<h2>Results<a class="headerlink" href="#Results" title="Permalink to this headline">¶</a></h2>
<p>Now we can run our algorithm and print out the results after a little
bit of post-processing to improve readability.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># run detection algorithm</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">dsp</span><span class="o">.</span><span class="n">detect_simpsons_paradox</span><span class="p">(</span><span class="n">auto_df</span><span class="p">)</span>

<span class="c1"># Map attribute index to attribute name</span>
<span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;attr1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;attr1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">continuousAttrs_labels</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;attr2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;attr2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">continuousAttrs_labels</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="c1"># sort for easy reading</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;attr1&#39;</span><span class="p">,</span> <span class="s1">&#39;attr2&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># data frames print neatly in notebooks</span>
<span class="n">result_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>allCorr</th>
      <th>attr1</th>
      <th>attr2</th>
      <th>reverseCorr</th>
      <th>groupbyAttr</th>
      <th>subgroup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.423329</td>
      <td>mpg</td>
      <td>acceleration</td>
      <td>-0.818873</td>
      <td>cylinders</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.423329</td>
      <td>mpg</td>
      <td>acceleration</td>
      <td>-0.341214</td>
      <td>cylinders</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.423329</td>
      <td>mpg</td>
      <td>acceleration</td>
      <td>-0.050545</td>
      <td>model year</td>
      <td>75</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.423329</td>
      <td>mpg</td>
      <td>acceleration</td>
      <td>-0.051280</td>
      <td>model year</td>
      <td>79</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.778427</td>
      <td>mpg</td>
      <td>horsepower</td>
      <td>0.620807</td>
      <td>cylinders</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.778427</td>
      <td>mpg</td>
      <td>horsepower</td>
      <td>0.013135</td>
      <td>cylinders</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Plotting">
<h2>Plotting<a class="headerlink" href="#Plotting" title="Permalink to this headline">¶</a></h2>
<p>We plot all data in scatter plots based on each group by attribute, for
each pair of candidate attributes. For each plot we add the overall
trendline and the trend line for each occurence of Simpson’s Paradox.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">auto_df</span><span class="o">.</span><span class="n">cylinders</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;model year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[8 4 6 3 5]
[70 71 72 73 74 75 76 77 78 79 80 81 82]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;8&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">}</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">:</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;8&#39;</span><span class="p">:</span><span class="s1">&#39;d&#39;</span><span class="p">}</span>

<span class="c1">#plt.scatter(auto_df[&#39;mpg&#39;], auto_df[&#39;acceleration&#39;], c=auto_df[&#39;cylinders&#39;].apply(lambda x: colors[str(x)]))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">])):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])],</span> <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])],</span> <span class="n">label</span><span class="o">=</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;acceleration&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1">#import matplotlib.patches as mpatches</span>
<span class="c1">#red_patch = mpatches.Patch(color=&#39;red&#39;, label=&#39;3&#39;)</span>
<span class="c1">#green_patch = mpatches.Patch(color=&#39;blue&#39;, label=&#39;4&#39;)</span>
<span class="c1">#purple_patch = mpatches.Patch(color=&#39;purple&#39;, label=&#39;5&#39;)</span>
<span class="c1">#black_patch = mpatches.Patch(color=&#39;black&#39;, label=&#39;6&#39;)</span>
<span class="c1">#green_patch = mpatches.Patch(color=&#39;green&#39;, label=&#39;8&#39;)</span>
<span class="c1">#plt.legend(handles=[red_patch, green_patch, blue_patch,black_patch,orange_patch])</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">by_label</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">by_label</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">by_label</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">})</span>

<span class="c1"># Add correlation line</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">]</span>

<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">X_plot</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">cylinder3</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">3</span><span class="p">]</span>
<span class="n">cylinder6</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">6</span><span class="p">]</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">cylinder3</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">cylinder3</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">]</span>

<span class="n">m1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#print(axes.get_xlim()[0])</span>
<span class="c1">#print(axes.get_xlim()[1])</span>
<span class="n">X_plot1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot1</span><span class="p">,</span> <span class="n">m1</span><span class="o">*</span><span class="n">X_plot1</span> <span class="o">+</span> <span class="n">b1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">cylinder6</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">cylinder6</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">]</span>

<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">X_plot</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#fig.savefig(&#39;auto1.jpg&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_exp_autompg_10_0.png" src="../_images/notebooks_exp_autompg_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;70&#39;</span><span class="p">:</span><span class="s1">&#39;coral&#39;</span><span class="p">,</span> <span class="s1">&#39;71&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;72&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;73&#39;</span><span class="p">:</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;74&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;75&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;76&#39;</span><span class="p">:</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;77&#39;</span><span class="p">:</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="s1">&#39;78&#39;</span><span class="p">:</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span><span class="s1">&#39;79&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;80&#39;</span><span class="p">:</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;81&#39;</span><span class="p">:</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span><span class="s1">&#39;82&#39;</span><span class="p">:</span><span class="s1">&#39;pink&#39;</span><span class="p">}</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;70&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;71&#39;</span><span class="p">:</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;72&#39;</span><span class="p">:</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;73&#39;</span><span class="p">:</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;74&#39;</span><span class="p">:</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;75&#39;</span><span class="p">:</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;76&#39;</span><span class="p">:</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="s1">&#39;77&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;78&#39;</span><span class="p">:</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="s1">&#39;79&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;80&#39;</span><span class="p">:</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;81&#39;</span><span class="p">:</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;82&#39;</span><span class="p">:</span><span class="s1">&#39;4&#39;</span><span class="p">}</span>

<span class="c1">#plt.scatter(auto_df[&#39;mpg&#39;], auto_df[&#39;acceleration&#39;], c=auto_df[&#39;cylinders&#39;].apply(lambda x: colors[str(x)]))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">])):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;model year&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])],</span> <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;model year&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])],</span> <span class="n">label</span><span class="o">=</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;model year&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>


<span class="c1">#plt.scatter(auto_df[&#39;mpg&#39;], auto_df[&#39;acceleration&#39;], c=auto_df[&#39;model year&#39;].apply(lambda x: colors[str(x)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;acceleration&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="c1">#import matplotlib.patches as mpatches</span>
<span class="c1">#patch1 = mpatches.Patch(color=&#39;coral&#39;, label=&#39;70&#39;)</span>
<span class="c1">#patch2 = mpatches.Patch(color=&#39;blue&#39;, label=&#39;71&#39;)</span>
<span class="c1">#patch3 = mpatches.Patch(color=&#39;purple&#39;, label=&#39;72&#39;)</span>
<span class="c1">#patch4 = mpatches.Patch(color=&#39;orange&#39;, label=&#39;73&#39;)</span>
<span class="c1">#patch5 = mpatches.Patch(color=&#39;green&#39;, label=&#39;74&#39;)</span>
<span class="c1">#patch6 = mpatches.Patch(color=&#39;black&#39;, label=&#39;75&#39;)</span>
<span class="c1">#patch7 = mpatches.Patch(color=&#39;grey&#39;, label=&#39;76&#39;)</span>
<span class="c1">#patch8 = mpatches.Patch(color=&#39;gold&#39;, label=&#39;77&#39;)</span>
<span class="c1">#patch9 = mpatches.Patch(color=&#39;lightgreen&#39;, label=&#39;78&#39;)</span>
<span class="c1">#patch10 = mpatches.Patch(color=&#39;red&#39;, label=&#39;79&#39;)</span>
<span class="c1">#patch11 = mpatches.Patch(color=&#39;cyan&#39;, label=&#39;80&#39;)</span>
<span class="c1">#patch12 = mpatches.Patch(color=&#39;skyblue&#39;, label=&#39;81&#39;)</span>
<span class="c1">#patch13 = mpatches.Patch(color=&#39;pink&#39;, label=&#39;82&#39;)</span>

<span class="c1">#plt.legend(handles=[patch1, patch2, patch3,patch4,patch5,patch6, patch7, patch8,patch9,patch10,patch11, patch12, patch13])</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">by_label</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">by_label</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">by_label</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">})</span>


<span class="c1"># Add correlation line</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">]</span>

<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">X_plot</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">cylinder3</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;model year&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">75</span><span class="p">]</span>
<span class="n">cylinder6</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;model year&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">79</span><span class="p">]</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">cylinder3</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">cylinder3</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">]</span>

<span class="n">m1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#print(axes.get_xlim()[0])</span>
<span class="c1">#print(axes.get_xlim()[1])</span>
<span class="n">X_plot1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot1</span><span class="p">,</span> <span class="n">m1</span><span class="o">*</span><span class="n">X_plot1</span> <span class="o">+</span> <span class="n">b1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">cylinder6</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">cylinder6</span><span class="p">[</span><span class="s1">&#39;acceleration&#39;</span><span class="p">]</span>

<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">X_plot</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#fig.savefig(&#39;auto2.jpg&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_exp_autompg_11_0.png" src="../_images/notebooks_exp_autompg_11_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;8&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">}</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">:</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;8&#39;</span><span class="p">:</span><span class="s1">&#39;d&#39;</span><span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">])):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])],</span> <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])],</span> <span class="n">label</span><span class="o">=</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

<span class="c1">#plt.scatter(auto_df[&#39;mpg&#39;], auto_df[&#39;horsepower&#39;], c=auto_df[&#39;cylinders&#39;].apply(lambda x: colors[str(x)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;horsepower&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="c1">#import matplotlib.patches as mpatches</span>
<span class="c1">#red_patch = mpatches.Patch(color=&#39;red&#39;, label=&#39;3&#39;)</span>
<span class="c1">#green_patch = mpatches.Patch(color=&#39;blue&#39;, label=&#39;4&#39;)</span>
<span class="c1">#purple_patch = mpatches.Patch(color=&#39;purple&#39;, label=&#39;5&#39;)</span>
<span class="c1">#black_patch = mpatches.Patch(color=&#39;black&#39;, label=&#39;6&#39;)</span>
<span class="c1">#green_patch = mpatches.Patch(color=&#39;green&#39;, label=&#39;8&#39;)</span>
<span class="c1">#plt.legend(handles=[red_patch, green_patch, blue_patch,black_patch,orange_patch])</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">by_label</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">by_label</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">by_label</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">},</span> <span class="n">loc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1"># Add correlation line</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]</span>

<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">X_plot</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">cylinder3</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">3</span><span class="p">]</span>
<span class="n">cylinder6</span> <span class="o">=</span> <span class="n">auto_df</span><span class="p">[</span><span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;cylinders&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">6</span><span class="p">]</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">cylinder3</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">cylinder3</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]</span>

<span class="n">m1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#print(axes.get_xlim()[0])</span>
<span class="c1">#print(axes.get_xlim()[1])</span>
<span class="n">X_plot1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot1</span><span class="p">,</span> <span class="n">m1</span><span class="o">*</span><span class="n">X_plot1</span> <span class="o">+</span> <span class="n">b1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">cylinder6</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">cylinder6</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">]</span>

<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_plot</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">X_plot</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#fig.savefig(&#39;auto3.jpg&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Chenguang Xu, Sarah M Brown, Christan E Grant.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/notebooks/exp_autompg.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>