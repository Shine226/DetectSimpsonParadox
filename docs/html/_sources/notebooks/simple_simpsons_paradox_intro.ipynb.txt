{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# What is Simpson's Paradox?\n",
    "\n",
    "An overview of Simpson's Paradox in the cases that we address in this project and how to detect it as well as breif complexity analysis of the problem"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pylab as plt\n",
    "import seaborn as sns\n",
    "\n",
    "# for outputting all alone variables\n",
    "from IPython.core.interactiveshell import InteractiveShell\n",
    "InteractiveShell.ast_node_interactivity = \"all\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "It's generally discussed in terms of two variables, both discrete, though binary or mulit level cases are both poputlar.  A popular example is the berkeley admissions data set.  the claim was that it was iased againt women because t the univerisyt sclae it ws, but fom os depeartments they actually admitted wmen at much higher rates  but the departments tha had low aceptance rates wer the ones with most of the women applicants"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Regression Based SImpson's Paradox\n",
    "\n",
    "\n",
    "It can manifest in how a decision variable relates to others that $x_k$ is predicted differently for different values of $x_j$ \n",
    "another way Simpson's Paradox could manifest is through latent clusters.  It can manifest in relationsships among variables.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/smb/anaconda2/envs/simpsonsparadox/lib/python3.6/site-packages/ipykernel_launcher.py:7: RuntimeWarning: covariance is not positive-semidefinite.\n",
      "  import sys\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x7f94388b2b70>"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "Text(0.5,0,'x_1')"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "Text(0,0.5,'x_2')"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# \n",
    "N = 100\n",
    "# sample data from 2 clusters\n",
    "mu = np.asarray([[1,1],[5,5]])\n",
    "\n",
    "z = np.random.randint(0,2,N)\n",
    "x = np.asarray([np.random.multivariate_normal(mu[z_i],[[.6,-1],[0,.6]]) for z_i in z])\n",
    "\n",
    "latent_df = pd.DataFrame(data=x,\n",
    "                       columns = ['x1', 'x2'])\n",
    "\n",
    "# now we add somoe more columns\n",
    "color_z = {0:'r', 1:'b'}\n",
    "char_zy = {0: {0:'x', 1:'o'}, 1:{0:'o', 1:'x'}}\n",
    "\n",
    "latent_df['color'] = [color_z[z_i] for z_i in z]\n",
    "y = np.random.choice([0,1],N,p=[.7,.3])\n",
    "latent_df['y'] = y\n",
    "latent_df['char'] = [char_zy[zi][yi] for zi,yi in zip(z,y)]\n",
    "\n",
    "plt.scatter(latent_df['x1'], latent_df['x2'],\n",
    "            c =  latent_df['color'], marker= 'o')\n",
    "#plt.scatter(clust_x['x1'], clust_x['x2'],\n",
    "          #  c =  clust_x['color'], marker= 'x')\n",
    "plt.xlabel('x_1')\n",
    "plt.ylabel('x_2')\n",
    "# , marker = 'char' , c = 'color'\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "in this, if we ignore the color, x_1 and x_2 are posiiely correlated, but in each color, they're negatively correlated.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.7995728839844514"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>x1</th>\n",
       "      <th>x2</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>color</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">b</th>\n",
       "      <th>x1</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.558943</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>x2</th>\n",
       "      <td>-0.558943</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">r</th>\n",
       "      <th>x1</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.580503</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>x2</th>\n",
       "      <td>-0.580503</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                x1        x2\n",
       "color                       \n",
       "b     x1  1.000000 -0.558943\n",
       "      x2 -0.558943  1.000000\n",
       "r     x1  1.000000 -0.580503\n",
       "      x2 -0.580503  1.000000"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "latent_df['x1'].corr(latent_df['x2'])\n",
    "latent_df.groupby('color')['x1','x2'].corr()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So, we can see that the correlation between $x_1$ and $x_2$ is positive in the whole data set and negative in each subgroup.  This is Simpson's paradox. So, to detect Simpson's Paradox in a data set with $d$ continuous variables and $c$ discrete variables, we can compute correlation matrix for all of the data, one $d \\times d$ matrix.  Then for each of the $c$ discrete variables with $k_c$ levels we compute an additional $d \\times d$ matrix$ for each level of each variable.  \n",
    "\n",
    "So, we need to compute $1+ \\sum_{i = 1}^c k_i$ correlation matrices of size $d \\times d$ and compare the signs of each element in the lower half of all the $\\sum_{i = 1}^c k_i$ for subgroup levels to the first one. "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
